<%= render 'firmen/form_modal' %>
<%= render 'orte/form_modal', ort_typ: "Start" %>
<%= render 'orte/form_modal', ort_typ: "Ziel" %>

<%= form_for(@transportabschnitt) do |f| %>
  <div class="btn-group header-buttons", class: "btn btn-primary">
     <%= f.submit "Abschnitt speichern", class:"btn btn-success" %>
  </div>
  
  <h3> Transportabschnitt </h3>
 


  <% if @transportabschnitt.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@transportabschnitt.errors.count, "error") %> prohibited this transportabschnitt from being saved:</h2>

      <ul>
      <% @transportabschnitt.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  
  <% if @transport %>
    <%= hidden_field_tag :transport_id, @transport.id %>
  <% end %>
  <% if @beobachtung_id %>
    <%= hidden_field_tag :beobachtung_id, @beobachtung_id %>
  <% end %>
  
  <div class="panel panel-default">
    <div class="panel-heading">
      <h2 class="panel-title">Start</h2>
    </div>
    <div class="panel-body">
      <p>
        <strong>Startdatum des Transportabschnittes:</strong><br>
        <div class='input-group date' id='datetimepicker-start'>
              <%= f.text_field :start_datum, start_year:1999, class: "form-control" %>
              <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
        </div>
      </p>
       <p>   
        <strong><%= f.label :start_ort, "Anfangsort: " %></strong><%= f.text_field :start_ort, disabled: true %>
        <div class='input-group ort' id='ort-start'>
          <% anlagen_ort = @transport.start_anlage.ort if @transport %>
          <% if anlagen_ort %>
            <%= hidden_field_tag :start_ort_ident, anlagen_ort.id %>
            <span class="btn btn-primary" onclick="setup_start_ort_wahl(<%= anlagen_ort.id %>,'<%= anlagen_ort.name %>')">Start-Anlage als Ort wÃ¤hlen</span>
          <% else %>
            <%= hidden_field_tag :start_ort_ident %>
          <% end %>
          <button class="btn btn-primary" data-toggle="modal" data-target="#ortModal-Start" type="button">Ort eingeben</button>

        </div>
      </p>
    </div>
  </div>
  
  <div class="panel panel-default">
    <div class="panel-heading">
      <h2 class="panel-title">Ende</h2>
    </div>
    <div class="panel-body">
      <div class="form-group">
        <strong>Ende des Transportabschnittes:</strong><br>
        <div class='input-group date' id='datetimepicker-ende'>
              <%= f.text_field :end_datum, start_year:1999, class: "form-control" %>
              <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
        </div>
      </div>
      <div class="form-group">
        <strong><%= f.label :end_ort, "Endort:" %></strong><%= f.text_field :end_ort, disabled: true %>
        <div class='input-group ort' id='ort-ende'>
          <% anlagen_ort = @transport.ziel_anlage.ort if @transport%>
          <% if anlagen_ort %>
            <span class="btn btn-primary" onclick="setup_ziel_ort_wahl(<%= anlagen_ort.id %>,'<%= anlagen_ort.name %>')">Ziel-Anlage als Ort wÃ¤hlen</span>
            <%= hidden_field_tag :ziel_ort_ident, anlagen_ort.id %>
          <% else %>
            <%= hidden_field_tag :ziel_ort_ident %>
          <% end %>
          <button class="btn btn-primary" data-toggle="modal" data-target="#ortModal-Ziel" type="button">Ort eingeben</button>
        </div>
      </div>
    </div>
  </div>
  
  <script type="text/javascript">
      setup_datetimepicker("#datetimepicker-start")
      setup_datetimepicker("#datetimepicker-ende")
  </script>
  
  <% if @transport %>
    <script type="text/javascript">
      //setup_start_und_ziel_anlagen_wahl(<%= @transport.start_anlage.ort %>, <%= @transport.ziel_anlage.ort %>)
    </script>
  <% end %>
    
  <div class="panel panel-default">
    <div class="panel-heading">
      <h2 class="panel-title">Verkehrsmittel</h2>
    </div>
    <div class="panel-body">
      <div class="field">
        Verkehrstraeger: 
        <%= f.select :verkehrstraeger, options_for_select(VERKEHRSTRAEGER_COMBOBOX, "unbekannt"), class: "form-control" %>
      </div>
      <div class="field">
        Transportfirma:
        <%= collection_select(:transportabschnitt, :firma_id, Firma.all, :id, :name) %>
        <button class="btn btn-success" data-toggle="modal" data-target="#firmaModal-" type="button">Neue Firma</button>
      </div>
    </div>
  </div>
 

  
<% end %>
