<div class="btn-group header-buttons">
  <%= link_to 'Bearbeiten', edit_transport_path(@transport) , class: "btn btn-primary" %>
  <%= link_to 'Löschen', @transport, method: :delete, data: { confirm: 'Willst du den Transport wirklich löschen?' }, class: "btn btn-danger" %></td>
</div>
<h1>Atomtransport</h1>

<%= render "show_transport_grunddaten", transport: @transport %>

<% if @transport.transportabschnitte.nil? || @transport.transportabschnitte.empty? %>
  Noch keine Transportabschnitte eingegeben.
  <%= link_to 'Neuer Transportabschnitt', new_transport_transportabschnitt_path(@transport) %> |
<% else %>
  <% umschlag_alt = nil; %>
  <% @transport.transportabschnitte.order(:end_datum).each do |abschnitt| %>
    
    <% if ((umschlag = @transport.umschlaege.find_by ort: abschnitt.start_ort) && umschlag != umschlag_alt ) %>
      <%= render "umschlaege/show_umschlag", umschlag: umschlag %>
    <% end %>
    
    <%= render "transportabschnitte/show_abschnitt", abschnitt: abschnitt %>
    
    <% if (umschlag = @transport.umschlaege.find_by ort: abschnitt.end_ort) %>
      <%= render "umschlaege/show_umschlag", umschlag: umschlag %>
      <% umschlag_alt = umschlag %>
    <% end %>
    
  <% end %>
<% end %>

  <%= link_to 'Neuer Transportabschnitt', new_transport_transportabschnitt_path(@transport) %> |
  <%= link_to 'Neuer Umschlag', new_transport_umschlag_path(@transport) %> |
  
  <%= link_to 'Alle Transporte anzeigen', transporte_path %>

